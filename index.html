<!DOCTYPE html>
<html class="w-screen h-screen select-none bg-gray-900 light-mode:bg-white text-gray-200">
  <head>
    <base target="_top">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <link rel="icon" href="https://marcomow.github.io/ocd/Logo_OCD.png" sizes="any" type="image/png">     
    
    <link rel='manifest' href='manifest.json'>
        
    <link href="https://marcomow.github.io/ocd/tailwind.css" rel="stylesheet">
    <style>
 
.grid-rows-12 {
    grid-template-rows: repeat(12,minmax(0,1fr));
}
.row-span-10 {
    grid-row: span 10/span 10;
}
.row-span-12 {
    grid-row: span 12/span 12;
}
</style>
<style>
 
html { 
  background: url(https://marcomow.github.io/ocd/Logo_OCD.png) no-repeat center center fixed; 
  -webkit-background-size: contain;
  -moz-background-size: contain;
  -o-background-size: contain;
  background-size: contain;
}
</style>  </head>
  <body class="grid grid-rows-12 w-screen h-screen">
   
    <app-main class="row-span-12"></app-main>
   
    
        
    <script>
class AppElement extends HTMLElement{
  constructor(){
    super(...arguments);
  
  }
}
</script>    
        
    <script>
class AppView extends AppElement{
  constructor(){
    super(...arguments);   
  
    const element_main = document.querySelector('app-main');
    
    element_main.innerHTML = '' ;
    
        
  }
  connectedCallback(){
    
    this.innerHTML = '' ;
    
    const that = this ;
    
    this.json?.array_contents
    .forEach(object_element=>{
    
      AppSectionItem.show(object_element,that) ;
    
    })
    ;
  
    this.connectedCallback_();
  
  }
  static async show(id_view,type_view){ 
    
    let element_view ;
    
    try { element_view = document.querySelector('#'+id_view); }
    catch(error){}
    
    const json = await fetch('https://marcomow.github.io/ocd/' + id_view + '.json')
    .then(response => response.json())
    .then(data => data);
        
    if(!element_view){ 
      
      element_view = document.createElement('app-'+type_view);
      
      element_view.id = id_view ;
      
      element_view.json = json ;
      
    }
    
    document.querySelector('app-main').appendChild(element_view) ;  
    
    return element_view;
  }
}
customElements.define('app-view',AppView);
</script>
    
        
    <script>
class AppSection extends AppView{
  constructor(){
    super(...arguments);
    
  }
  connectedCallback_(){
    
    this.classList.add('grid');
    
    const that = this ;

      
  }
}
customElements.define('app-section',AppSection);
</script>    
        
    <script>
class AppSectionItem extends AppElement {
  constructor(){
    super(...arguments);
    
  }
  connectedCallback(){ 
    
    this.classList.add('w-full','p-4','border','focus:bg-blue-100','bg-gray-900','light-mode:bg-white','bg-opacity-75');
        
    this.innerHTML = this.name ;
    
    const that = this ; 
    
    this.addEventListener('click',()=>{
      
      navigator.vibrate(100);
      
      AppView.show(that.object_element.id,that.object_element.type);
      
    });
    
  }
  static show(object_element,element_parent){
    
    const id_element = 'item-'+object_element.id
    
    let element_section_item = element_parent.querySelector('#'+id_element);
    
    if(!element_section_item){ 
      
      element_section_item = document.createElement('app-section-item');
      
      element_section_item.id = id_element ;
      
      element_section_item.name = object_element.name ;
      
      element_section_item.object_element = object_element ;
      
    }
    
    element_parent.appendChild(element_section_item) ;  
    
    return element_section_item;
  
  }
}
customElements.define('app-section-item',AppSectionItem);
</script>    
        
    <script>
class AppPage extends AppView{
  constructor(){
    super(...arguments);
    
  }
  connectedCallback_(){
  
    this.classList.add('flex','flex-wrap','h-full','overflow-hidden');
    
    const element_content = document.createElement('app-page-content');
    
    element_content.html = this.json.html ;
    
    this.appendChild(element_content) ;
  
  }
}
customElements.define('app-page',AppPage);
</script>
<script>
class AppPageContent extends AppElement {
  constructor(){
    super(...arguments);
  }
  connectedCallback(){
    
    this.classList.add('overflow-auto','p-4','pt-8','h-full','bg-gray-900','light-mode:bg-white','bg-opacity-75');
    
    this.style['scroll-snap-type'] = 'y mandatory';
    
    this.innerHTML = this.html ;
    
    const fix_css = (element_style)=>{
    
      const array_properties_accepted = ['color','font-weight','font-size'];
      
      const array_values_forbidden = [
      {name:'color',value:'#000000'}
      ];
      
      const text_raw = element_style.innerHTML;
      
      const text_fixed = text_raw.split('}')
      .map(segment_rule=>{
        
        if(!segment_rule.includes('{')){ return segment_rule; }
        
        const rule_prefix = segment_rule.split('{')[0];
        
        const rule_content_raw = segment_rule.split('{')[1];
        
        const rule_content_fixed = rule_content_raw.split(';')
        .filter(property=>{
                    
          const name_property = property.split(':')[0];
          
          if(!array_properties_accepted.includes(name_property)){ return false ; }
          
          const object_forbidden = array_values_forbidden.find(obj=>obj.name===name_property) ; 
          
          if(!object_forbidden){ return true ;}
          
          const value_property = property.split(':')[1].trim() ;
          
          return object_forbidden.value !== value_property ;
        
        })
        .join(';')
        ;
        
        return rule_prefix + '{' + rule_content_fixed ; 
              
      })
      .join('}');
      
      element_style.innerHTML = text_fixed ;
    
    }
    
    Array.from(this.querySelectorAll('style')).forEach(fix_css);
    
    Array.from(this.querySelectorAll('p')).forEach(element=>{
      element.style['scroll-snap-align']='start';
      
      element.classList.add('p-2');
      
      });
  
  }
}
customElements.define('app-page-content',AppPageContent);
</script>    
        
    <script>
class AppHeader extends AppElement{
  constructor(){
    super(...arguments);
    
  }
}
customElements.define('app-header',AppHeader) ;
</script>    
        
    <script>
class AppMain extends AppElement{
  constructor(){
    super(...arguments);
    
    const element_view = document.createElement('app-section');
    
    this.innerHTML = '';
    
    this.appendChild(element_view);
  
  }
  connectedCallback(){
    
    const element_view = AppView.show('root','section');
    
    this.classList.add('overflow-hidden');
    
  }
}
customElements.define('app-main',AppMain) ;
</script>    
        
    <script>
class AppFooter extends AppElement{
  constructor(){
    super(...arguments);
    
  
  }
}
customElements.define('app-footer',AppFooter) ;
</script>    
        <script type="module" src="/service-worker.js"></script>
  </body>
</html>


